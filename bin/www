#!/usr/bin/env node

const compress = require('koa-compress');

const PORT = process.env.PORT || 7100;
const env = process.env.NODE_ENV || 'production';
const src = env === 'production' ? './../src/app.js' : './../src/app.js';

const app = require(src).default;

if (env === 'development') {

    app.use(async function(ctx, next) {
        console.log(ctx.method + ' ' + ctx.url);
        await next();
    });

} else {
    // HTTP compression
    app.use(compress({}));
}

app.listen(PORT, function() {
    console.log("Server listening on port: " + PORT);
});